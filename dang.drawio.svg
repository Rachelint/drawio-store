<?xml version="1.0" encoding="UTF-8"?>
<!-- Do not edit this file with editors other than diagrams.net -->
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" style="background-color: rgb(255, 255, 255);" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="442px" height="632px" viewBox="-0.5 -0.5 442 632" content="&lt;mxfile host=&quot;app.diagrams.net&quot; modified=&quot;2023-04-22T15:07:58.071Z&quot; agent=&quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:109.0) Gecko/20100101 Firefox/112.0&quot; etag=&quot;HB_RE3f6CrenbriryQvr&quot; version=&quot;21.2.1&quot; type=&quot;github&quot;&gt;&lt;diagram name=&quot;第 1 页&quot; id=&quot;XUci2lNG4BiP5mjnEFRW&quot;&gt;7VrJbuM4EP0aAp1DB6JW6ig5cg9mOyQZdOcUEBZjqUOLBk3H9nz9FCXKkiw58QDeutFAgJDF4qJXrx6XBDmj2fqLpPPsL5EyjmwrXSPnDtk2xqEHv7RlU1k84lSGqcxT49QYHvJ/mTFaxrrMU7boOCohuMrnXeNEFAWbqI6NSilWXbcXwbuzzumU9QwPE8r71q95qrLKSuygsf/G8mlWz4z9sGqZ0drZfMkio6lYtUxOgpyRFEJVpdl6xLgGr8al6jfe07pdmGSFOqSD8Glx/9m6HwsxUYuvc5qL3z87ZnFvlC/NF5vVqk0NgRTLImV6FAs58SrLFXuY04luXUHQwZapGYcahmJKF1npqytmbCYVW+9dNd5iASRiYsaU3IBL3cE1KzT8sYmpr5po4BrirB2J2pEaBky3YzcgQcHg9D8wC44M2RFQcnAXJcceQMkZQOlkIHlXBNJmh0ofUcc5FSh22AOBpSA3piqkysRUFJQnjTXuwtT4/CnE3IDznSm1MdpJl0p0oWPrXH3T3W89U3tqtdytzchlZVNXCvjeb7Wbrjw1I+hq062s1f2q79Mf9X6QAAOxlBP2DljEqD2VU6beAzUYjrpknKr8rbuQo4eU9Hg++uf+Pvn78fkxevijH27OYedi5xEFe0cUvAH+4wH+u6fif9gD6zGTjKZg4wL23B5c8PGqi8tCSfHKRoILCZZCFBrLl5zzHRPl+bSA6gTAYmCPNZQ5zBGZhlmepnxfILo5d4xYOMGt96FEB94ZxQh7P4oYHVFUsH2gqmD3kqpSL7OVKeOlWkp2UUHB/o6gDGyo4Tn1BAc/CoW3+2lrC33q7KAn308rRh9Cff+i1Hd71AdSr4qrYr6LL8z87aXyF/MPYL5/KPPDizLf38N8J4KfueD8+aXcBJ4LofKXTY8B5751Yqd7pHHDgQOme9YLVv+W+Sst3mf7ITesPTQ4U1r0bw2ttKiO99eWCZ7nXToTcA+1q0PJH3qlGkIJnw4mpwfTAnLhp72H4uDjEPhn5Sm5pGLjll436v2RYl/sScw+9CBDLinYdv8cgxIPxRYi0GJBvKRYsfSRLl6h+gklLooJimOUEBT5iGDtTUaIeLoAZ4oIMLSqM88n6xYy1jJ9ojuUBCiMEHFX9JXJmxuUjFE80r0TH4XglJSDET074Lbz2gTjhIgE2v3qtHHosW5IG/2TZebQ3zl8rnUwzd+gONVFHTQdWaeMhIsioJ5l3iq251Zkj+qusJR276EBIV5jFI3L2Fg6unqKsY6TZj6Qphx3spQltjqIBJEExYHpGvoHT9bm4iARgUREr6Xm382+oa+MPsHABfW89HEGDiAazgBFgeYKCXVa2taLedeyymQfaQKBG7RqN8Ael8nslf53JSccFJcFcCZWVzTKVG+rR5355gmhJRw/7xbvdqlgD93K8HFemqHa/AG7bGv9G4CT/Ac=&lt;/diagram&gt;&lt;/mxfile&gt;"><defs/><g><rect x="140" y="140" width="120" height="180" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-dasharray="3 3" pointer-events="all"/><rect x="310" y="180" width="130" height="80" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><rect x="0" y="0" width="120" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><path d="M 375 250 L 375 600 L 281.37 600" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 276.12 600 L 283.12 596.5 L 281.37 600 L 283.12 603.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><ellipse cx="375" cy="230" rx="55" ry="20" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 108px; height: 1px; padding-top: 230px; margin-left: 321px;"><div style="box-sizing: border-box; font-size: 0px; text-align: center;" data-drawio-colors="color: rgb(0, 0, 0); "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">CURRENT_TASK</div></div></div></foreignObject><text x="375" y="234" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">CURRENT_TASK</text></switch></g><rect x="337.5" y="180" width="75" height="30" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 73px; height: 1px; padding-top: 195px; margin-left: 339px;"><div style="box-sizing: border-box; font-size: 0px; text-align: center;" data-drawio-colors="color: rgb(0, 0, 0); "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">Thread local</div></div></div></foreignObject><text x="375" y="199" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">Thread local</text></switch></g><path d="M 205 240 L 205 260 L 205 250 L 205 263.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 205 268.88 L 201.5 261.88 L 205 263.63 L 208.5 261.88 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><ellipse cx="205" cy="220" rx="45" ry="20" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 88px; height: 1px; padding-top: 220px; margin-left: 161px;"><div style="box-sizing: border-box; font-size: 0px; text-align: center;" data-drawio-colors="color: rgb(0, 0, 0); "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">Future</div></div></div></foreignObject><text x="205" y="224" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">Future</text></switch></g><path d="M 205 310 L 205 343.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 205 348.88 L 201.5 341.88 L 205 343.63 L 208.5 341.88 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><ellipse cx="205" cy="290" rx="45" ry="20" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 88px; height: 1px; padding-top: 290px; margin-left: 161px;"><div style="box-sizing: border-box; font-size: 0px; text-align: center;" data-drawio-colors="color: rgb(0, 0, 0); "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">Spawn</div></div></div></foreignObject><text x="205" y="294" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">Spawn</text></switch></g><path d="M 205 380 L 205 408.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 205 413.88 L 201.5 406.88 L 205 408.63 L 208.5 406.88 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><rect x="135" y="350" width="140" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 138px; height: 1px; padding-top: 365px; margin-left: 136px;"><div style="box-sizing: border-box; font-size: 0px; text-align: center;" data-drawio-colors="color: rgb(0, 0, 0); "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">Spawn::poll_future_notify</div></div></div></foreignObject><text x="205" y="369" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">Spawn::poll_future_noti...</text></switch></g><path d="M 205 445 L 205 473.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 205 478.88 L 201.5 471.88 L 205 473.63 L 208.5 471.88 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><rect x="135" y="415" width="140" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 138px; height: 1px; padding-top: 430px; margin-left: 136px;"><div style="box-sizing: border-box; font-size: 0px; text-align: center;" data-drawio-colors="color: rgb(0, 0, 0); "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">Spawn::enter</div></div></div></foreignObject><text x="205" y="434" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">Spawn::enter</text></switch></g><rect x="135" y="480" width="140" height="130" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><rect x="175" y="480" width="60" height="30" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 58px; height: 1px; padding-top: 495px; margin-left: 176px;"><div style="box-sizing: border-box; font-size: 0px; text-align: center;" data-drawio-colors="color: rgb(0, 0, 0); "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">set</div></div></div></foreignObject><text x="205" y="499" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">set</text></switch></g><path d="M 275 540 L 297.5 540 L 297.5 230 L 313.63 230" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 318.88 230 L 311.88 233.5 L 313.63 230 L 311.88 226.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><rect x="135" y="510" width="140" height="60" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 138px; height: 1px; padding-top: 540px; margin-left: 136px;"><div style="box-sizing: border-box; font-size: 0px; text-align: center;" data-drawio-colors="color: rgb(0, 0, 0); "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">将 BorrowedTask (主要包含 notify(0.3 中的waker))，放到 thread local 里</div></div></div></foreignObject><text x="205" y="544" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">将 BorrowedTask (主要包含 notify(...</text></switch></g><rect x="135" y="570" width="140" height="60" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 138px; height: 1px; padding-top: 600px; margin-left: 136px;"><div style="box-sizing: border-box; font-size: 0px; text-align: center;" data-drawio-colors="color: rgb(0, 0, 0); "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><div>调用 Future::poll,</div><div>可通过 task::current 获取</div><div>BorrowedTask(主要是 notify)</div></div></div></div></foreignObject><text x="205" y="604" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">调用 Future::poll,...</text></switch></g><rect x="145" y="150" width="115" height="30" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 113px; height: 1px; padding-top: 165px; margin-left: 146px;"><div style="box-sizing: border-box; font-size: 0px; text-align: center;" data-drawio-colors="color: rgb(0, 0, 0); "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">旧版 future 在执行前都需要先包到 Spawn 中</div></div></div></foreignObject><text x="203" y="169" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">旧版 future 在执行前都需要先包到 Spawn 中</text></switch></g></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://www.diagrams.net/doc/faq/svg-export-text-problems" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Text is not SVG - cannot display</text></a></switch></svg>