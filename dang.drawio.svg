<?xml version="1.0" encoding="UTF-8"?>
<!-- Do not edit this file with editors other than diagrams.net -->
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<svg xmlns="http://www.w3.org/2000/svg" style="background-color: rgb(255, 255, 255);" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="307px" height="492px" viewBox="-0.5 -0.5 307 492" content="&lt;mxfile host=&quot;app.diagrams.net&quot; modified=&quot;2023-04-22T15:10:52.695Z&quot; agent=&quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10.15; rv:109.0) Gecko/20100101 Firefox/112.0&quot; etag=&quot;l--R3Z1fXuLqkgveV8QQ&quot; version=&quot;21.2.1&quot; type=&quot;github&quot;&gt;&lt;diagram name=&quot;第 1 页&quot; id=&quot;XUci2lNG4BiP5mjnEFRW&quot;&gt;7Vnbbts4EP0aAs1DA1FX6lFy5C729pBk0eYpICzaUkOLBk3H9n79DiXKkiI58QK+tSgQIJzhDEmdOTO8GDmj+eaLpIvsL5Eyjmwr3SDnDtk2xqEH/7RmW2k84lSKmcxTY9QoHvJ/mVFaRrvKU7bsGCohuMoXXeVEFAWbqI6OSinWXbOp4N1ZF3TGeoqHCeV97dc8VVmlJXbQ6H9j+SyrZ8Z+WPXMaW1svmSZ0VSsWyonQc5ICqGq1nwzYlyDV+NS+Y339O4WJlmhDnEQPi3uP1v3YyEmavl1QXPx+2fHLO6V8pX5YrNata0hkGJVpEyPYiEnXme5Yg8LOtG9awg66DI15yBhaKZ0mZW2WjBjM6nYZu+q8Q4LIBETc6bkFkxqB9es0PDHJkZeN9HANcRZOxK1ITUMmO3GbkCChsHpf2AWHBmyI6Dk4C5Kjj2AkjOA0slAssMeKCyFzDKikCoTM1FQnjTauAtbY/OnEAsD1nem1NaUCbpSogsl2+Tqm3a/9Yz01Oq525iRS2FbCwV877faTAtPzQhabNxKqfarvk9/1PtBAwzESk7YO2ARU9ionDH1HqjBMAsk41Tlr92FHD2kpMf70T/398nfj8+P0cMf/XBzDkWanYf/9hv+ewP8xwP8d0/F/7AH1mMmGU1BxwVsLz244ONVF5elkuKFjQQXEjSFKDSW05zzNyrK81kB4gTAYqCPNZQ5zBGZjnmepnxfILo5d4xYOMGt92E1Crx+MJxTBQN7P0oxOmJRwfaBVQW7l6wq9TJbmTJeqZVkFy0o2H9TUNw+hcNz1hMc/CgU3u2nrS30qbODnnw/rRh9CPX9i1Lf7VEfSL0uror5Lr4w83f3p1/MP4D5/qHMDy/KfH8P850I/haC8+dpuQk8F0Ll022PAee+YGGne6Rxw4EDpjuQFic70wzcOn+lxftsP+SGtYcGZ0qL/q2hlRbV8f7aMsHzvEtnAu6hdnUo+UMPMkMo4dPB5PRgWkIu/LT3UBx8HAL/rDwll6zYuFWvm+r9UcW+2JOYfehBhlyyYNv9cwxKPBRbiECPBfGSYs3SR7p8AfETSlwUExTHKCEo8hHB2pqMEPF0A84UEWBoVWeeT9YtZKxlfKI7lAQojBBx1/SFyZsblIxRPNLeiY9CMErKwYieHXB789oE44SIBNr86mrj0GPdUG30T5aZQ0/6Ptd1MM1foTnTTR00HVmnjISLIqCeZd4qdudWZI9qV1hK23toQIjXGEXjMjaWjq6eYqzjpJkPpCnHnaxkia0OIkEkQXFgXEP/4MnaXBwkIpCI6LXU/LvZN/SV0ScYuKCelz7OwAFEwxmgKNBcIaFOS9uamnctq0z2kSYQmEGvNgPscZnMXml/V3LCQXHZAGNidYtGmert6lFnvnlCaBWOn3eLd7tUsIduZfg4L80gNr/Vln2tX7yd5D8=&lt;/diagram&gt;&lt;/mxfile&gt;"><defs/><g><rect x="5" y="0" width="120" height="180" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" stroke-dasharray="3 3" pointer-events="all"/><rect x="175" y="40" width="130" height="80" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><path d="M 240 110 L 240 460 L 146.37 460" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 141.12 460 L 148.12 456.5 L 146.37 460 L 148.12 463.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><ellipse cx="240" cy="90" rx="55" ry="20" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 108px; height: 1px; padding-top: 90px; margin-left: 186px;"><div style="box-sizing: border-box; font-size: 0px; text-align: center;" data-drawio-colors="color: rgb(0, 0, 0); "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">CURRENT_TASK</div></div></div></foreignObject><text x="240" y="94" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">CURRENT_TASK</text></switch></g><rect x="202.5" y="40" width="75" height="30" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 73px; height: 1px; padding-top: 55px; margin-left: 204px;"><div style="box-sizing: border-box; font-size: 0px; text-align: center;" data-drawio-colors="color: rgb(0, 0, 0); "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">Thread local</div></div></div></foreignObject><text x="240" y="59" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">Thread local</text></switch></g><path d="M 70 100 L 70 120 L 70 110 L 70 123.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 70 128.88 L 66.5 121.88 L 70 123.63 L 73.5 121.88 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><ellipse cx="70" cy="80" rx="45" ry="20" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 88px; height: 1px; padding-top: 80px; margin-left: 26px;"><div style="box-sizing: border-box; font-size: 0px; text-align: center;" data-drawio-colors="color: rgb(0, 0, 0); "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">Future</div></div></div></foreignObject><text x="70" y="84" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">Future</text></switch></g><path d="M 70 170 L 70 203.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 70 208.88 L 66.5 201.88 L 70 203.63 L 73.5 201.88 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><ellipse cx="70" cy="150" rx="45" ry="20" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 88px; height: 1px; padding-top: 150px; margin-left: 26px;"><div style="box-sizing: border-box; font-size: 0px; text-align: center;" data-drawio-colors="color: rgb(0, 0, 0); "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">Spawn</div></div></div></foreignObject><text x="70" y="154" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">Spawn</text></switch></g><path d="M 70 240 L 70 268.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 70 273.88 L 66.5 266.88 L 70 268.63 L 73.5 266.88 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><rect x="0" y="210" width="140" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 138px; height: 1px; padding-top: 225px; margin-left: 1px;"><div style="box-sizing: border-box; font-size: 0px; text-align: center;" data-drawio-colors="color: rgb(0, 0, 0); "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">Spawn::poll_future_notify</div></div></div></foreignObject><text x="70" y="229" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">Spawn::poll_future_noti...</text></switch></g><path d="M 70 305 L 70 333.63" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 70 338.88 L 66.5 331.88 L 70 333.63 L 73.5 331.88 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><rect x="0" y="275" width="140" height="30" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 138px; height: 1px; padding-top: 290px; margin-left: 1px;"><div style="box-sizing: border-box; font-size: 0px; text-align: center;" data-drawio-colors="color: rgb(0, 0, 0); "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">Spawn::enter</div></div></div></foreignObject><text x="70" y="294" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">Spawn::enter</text></switch></g><rect x="0" y="340" width="140" height="130" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><rect x="40" y="340" width="60" height="30" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 58px; height: 1px; padding-top: 355px; margin-left: 41px;"><div style="box-sizing: border-box; font-size: 0px; text-align: center;" data-drawio-colors="color: rgb(0, 0, 0); "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">set</div></div></div></foreignObject><text x="70" y="359" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">set</text></switch></g><path d="M 140 400 L 162.5 400 L 162.5 90 L 178.63 90" fill="none" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="stroke"/><path d="M 183.88 90 L 176.88 93.5 L 178.63 90 L 176.88 86.5 Z" fill="rgb(0, 0, 0)" stroke="rgb(0, 0, 0)" stroke-miterlimit="10" pointer-events="all"/><rect x="0" y="370" width="140" height="60" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 138px; height: 1px; padding-top: 400px; margin-left: 1px;"><div style="box-sizing: border-box; font-size: 0px; text-align: center;" data-drawio-colors="color: rgb(0, 0, 0); "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">将 BorrowedTask (主要包含 notify(0.3 中的waker))，放到 thread local 里</div></div></div></foreignObject><text x="70" y="404" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">将 BorrowedTask (主要包含 notify(...</text></switch></g><rect x="0" y="430" width="140" height="60" fill="rgb(255, 255, 255)" stroke="rgb(0, 0, 0)" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 138px; height: 1px; padding-top: 460px; margin-left: 1px;"><div style="box-sizing: border-box; font-size: 0px; text-align: center;" data-drawio-colors="color: rgb(0, 0, 0); "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;"><div>调用 Future::poll,</div><div>可通过 task::current 获取</div><div>BorrowedTask(主要是 notify)</div></div></div></div></foreignObject><text x="70" y="464" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">调用 Future::poll,...</text></switch></g><rect x="10" y="10" width="115" height="30" fill="none" stroke="none" pointer-events="all"/><g transform="translate(-0.5 -0.5)"><switch><foreignObject style="overflow: visible; text-align: left;" pointer-events="none" width="100%" height="100%" requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"><div xmlns="http://www.w3.org/1999/xhtml" style="display: flex; align-items: unsafe center; justify-content: unsafe center; width: 113px; height: 1px; padding-top: 25px; margin-left: 11px;"><div style="box-sizing: border-box; font-size: 0px; text-align: center;" data-drawio-colors="color: rgb(0, 0, 0); "><div style="display: inline-block; font-size: 12px; font-family: Helvetica; color: rgb(0, 0, 0); line-height: 1.2; pointer-events: all; white-space: normal; overflow-wrap: normal;">旧版 future 在执行前都需要先包到 Spawn 中</div></div></div></foreignObject><text x="68" y="29" fill="rgb(0, 0, 0)" font-family="Helvetica" font-size="12px" text-anchor="middle">旧版 future 在执行前都需要先包到 Spawn 中</text></switch></g></g><switch><g requiredFeatures="http://www.w3.org/TR/SVG11/feature#Extensibility"/><a transform="translate(0,-5)" xlink:href="https://www.diagrams.net/doc/faq/svg-export-text-problems" target="_blank"><text text-anchor="middle" font-size="10px" x="50%" y="100%">Text is not SVG - cannot display</text></a></switch></svg>